<ng-container *ngIf="post$ | async as post">
    <div class="ml-4 mr-4 md:ml-20 md:mr-20 mb-4">
        <app-title [typePage]="'post'" [title]="post.title"></app-title>

        <div class="flex flex-wrap mb-6">
            <span class="mr-8">{{post.updatedAt | date:'dd/MM/yyyy'}}</span>
            <span class="mr-8">{{post.user.name}}</span>
            <span>{{post.subject.title}}</span>
        </div>

        <p class="mt-4 text-justify">{{ post.content }}</p>
    </div>
    
    <div class="w-[90%] mx-auto mt-4 border-2 border-b border-black"></div>
    <div class="ml-2 mr-2 md:ml-20 md:mr-20">
        <div class="mt-4">
            <h2 class="text-xl font-bold mb-6 ml-4">{{ labelsForInterface.comments }}</h2>

            <ng-container *ngIf="useCommentSubject">
                <div *ngFor="let comment of commentBehaviorSubject | async" class="mb-6 pb-4">
                    <div class="block md:hidden mb-2">
                        <div class="text-right font-medium">{{ comment.user.name }}</div>
                    </div>
                    <div class="block md:hidden">
                        <p class="w-full pt-3 px-4 rounded-lg bg-gray-200 min-h-20">{{comment.message}}</p>
                    </div>

                    <div class="hidden md:flex gap-4 items-start ml-3">
                        <div class="w-20 text-right font-medium">{{ comment.user.name }}</div>
                        <p class="pt-3 px-4 flex-1 rounded-lg bg-gray-200 min-h-20">{{comment.message}}</p>
                    </div>
                </div>
            </ng-container>

            <ng-container *ngIf="!useCommentSubject">   
                <div *ngFor="let comment of post.comments" class="mb-6 pb-4">
                    <div class="block md:hidden mb-2">
                        <div class="text-right font-medium">{{ comment.user.name }}</div>
                    </div>
                    <div class="block md:hidden">
                        <p class="pt-3 px-4 rounded-lg bg-gray-200 min-h-20">{{comment.message}}</p>
                    </div>

                    <div class="hidden md:flex gap-4 items-start ml-3">
                        <div class="w-20 text-right font-medium">{{ comment.user.name }}</div>
                        <p class="pt-3 px-4 flex-1 rounded-lg bg-gray-200 min-h-20">{{comment.message}}</p>
                    </div>
                </div>
            </ng-container>
        </div>
        
        <div>
            <form [formGroup]="commentForm" class="flex gap-4 items-start">
                <textarea 
                    matInput 
                    placeholder="{{ labelsForInterface.ph_inputComment }}" 
                    formControlName="message"
                    class="md:ml-10 w-full h-[120px] mb-2 !border !border-black !rounded-lg !px-3 !py-3 focus:!border-blue-500 min-h-24">
                </textarea>
                <button 
                    type="submit" 
                    [disabled]="commentForm.invalid"
                    (click)="onMessageSubmit()"
                    class="flex-shrink-0 relative top-10">
                    <img src="assets/send.png" alt="send" class="w-12 h-12"/>
                </button>
                <div class="flex-1"></div>
            </form>
        </div>
    </div>
    
</ng-container>